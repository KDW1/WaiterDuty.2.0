<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Hello Bulma!</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    <script src="https://kit.fontawesome.com/eefa1d8796.js" crossorigin="anonymous"></script>
</head>
<body>
    <% if(locals.errorMsg) { %>
        <script>
            alert('<%=locals.errorMsg%>')
        </script>
    <% } %>  
    <h1 style="text-align: center;">Cadets Info</h1>
    <table style="margin: 12px auto;">
        <tr>
            <th>Cadet Name:</th>
            <th style="padding-left:12px;">Shifts</th>
            <th style="padding-left:12px;">Monday:</th>
            <th style="padding-left:12px;">Tuesday:</th>
            <th style="padding-left:12px;">Thursday:</th>
            <th style="padding-left:12px;">Friday:</th>
        </tr>
        <% if(locals.cadetList) { %>
            <% locals.cadetList.forEach((cadet) => {%>
                <tr>
                    <td><%= cadet.cadetName %></th>
                    <td style="padding-left:12px;"><%= cadet.shiftAmounts %></td>
                    <td style="padding-left:12px;"><%= cadet.parsedLunchTimes[0] %></th>
                    <td style="padding-left:12px;"><%= cadet.parsedLunchTimes[1] %></th>
                    <td style="padding-left:12px;"><%= cadet.parsedLunchTimes[3] %></th>
                    <td style="padding-left:12px;"><%= cadet.parsedLunchTimes[4] %></th>
                    <td style="padding-left:12px;"><a href="/deleteCadet?cadetName=<%= cadet.cadetName %>">Delete</a></th>
                </tr>
            <% })%> 
        <% } %>  
    </table>
    <div>
        <h2 style="text-align: center;">Add a Cadet</h2>
        <form style="text-align: center;" action="/addCadet" method="POST">
            <input type="text" name="cadetName" id=""><br>
            <select style="margin-top: 5px;" name="mon">
                <option selected>Daily Lunches</option>
                <option value=1>1st Lunch</option>
                <option value=2>2nd Lunch</option>
                <option value=3>3rd Lunch</option>
                <option value=0>Free Period</option>
                <option value=5>Can't Make It</option>
            </select><br>
            <select style="margin-top: 5px;" name="tues">
                <option selected>Daily Lunches</option>
                <option value=1>1st Lunch</option>
                <option value=2>2nd Lunch</option>
                <option value=3>3rd Lunch</option>
                <option value=0>Free Period</option>
                <option value=5>Can't Make It</option>
            </select><br>
            <select style="margin-top: 5px;" name="thurs">
                <option selected>Daily Lunches</option>
                <option value=1>1st Lunch</option>
                <option value=2>2nd Lunch</option>
                <option value=3>3rd Lunch</option>
                <option value=0>Free Period</option>
                <option value=5>Can't Make It</option>
            </select><br>
            <select style="margin-top: 5px;" name="fri">
                <option selected>Daily Lunches</option>
                <option value=1>1st Lunch</option>
                <option value=2>2nd Lunch</option>
                <option value=3>3rd Lunch</option>
                <option value=0>Free Period</option>
                <option value=5>Can't Make It</option>
            </select><br>
            <input style="margin-top: 5px;" type="submit" value="Click Me">
        </form>
    </div>
    <p style="padding-top: 20px; text-align: center;">
        <a style="text-align:center; margin: 0 auto;" href="localhost:3000/roster">
            Make Roster
        </a>
    </p>
    <h1 style="text-align:center; padding-top: 24px;">Roster</h1>
    <div style="text-align:center; padding-top: 12px;">
        
        <% for(let i = 0; i < 5; i++) { %>
            <% let days = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday'] %> 
            <h3><%= days[i].charAt(0).toUpperCase() + days[i].slice(1) %> Schedule</h3>
            <table style="margin: 24px auto;">
                <% if(locals.roster) { %> 
                    <% data = roster[days[i]] %> 
                    <% function iterateShifts(arr) {
                        let terms = [];
                        terms = arr.map((data) => {
                            return data.assignedPerson;
                        })
                        return terms.join(", ");
                    } %> 
                    <tr><th>Breakfast</th><td><%= iterateShifts(data.breakfast) %></td></tr>
                    <% if(i != 2) { %>
                        <tr><th>1st Lunch</th><td><%= iterateShifts(data.lunches.firstLunch) %></td></tr>
                        <tr><th>2nd Lunch</th><td><%= iterateShifts(data.lunches.secondLunch) %></td></tr>
                        <tr><th>3rd Lunch</th><td><%= iterateShifts(data.lunches.thirdLunch) %></td></tr>
                    <% } %>  
                    <tr><th>1st Dinner</th><td><%= iterateShifts(data.dinners.firstDinner) %></td></tr>
                    <tr><th>2nd Dinner</th><td><%= iterateShifts(data.dinners.secondDinner) %></td></tr>
                <% } %> 
            </table>
        <% } %>  
    </div>
</body>
</html>
